import{s as A,n as V,r as x,o as B,b as Z}from"../chunks/scheduler.Ce_0Mfso.js";import{S as D,i as F,e as f,t as Y,s as W,c as v,a as _,b as T,d as w,f as g,k as R,l as C,g as U,h as o,m as X,j as z}from"../chunks/index.CT52lF6p.js";import{a as P,b as q,c as L}from"../chunks/index.CU4dFde9.js";const Q=!1,H=!0,ne=Object.freeze(Object.defineProperty({__proto__:null,prerender:H,ssr:Q},Symbol.toStringTag,{value:"Module"}));function K(d){let t,n,I,s,h,y,c,a,O="join",l,u,E="leave",k,m,N,i,M,b,r,j;return{c(){t=f("main"),n=f("p"),I=Y("ID: "),s=f("span"),h=Y(d[2]),y=W(),c=f("div"),a=f("button"),a.textContent=O,l=W(),u=f("button"),u.textContent=E,k=W(),m=f("video"),N=W(),i=f("div"),M=W(),b=f("div"),this.h()},l(p){t=v(p,"MAIN",{});var e=_(t);n=v(e,"P",{});var J=_(n);I=T(J,"ID: "),s=v(J,"SPAN",{id:!0});var S=_(s);h=T(S,d[2]),S.forEach(w),J.forEach(w),y=g(e),c=v(e,"DIV",{});var G=_(c);a=v(G,"BUTTON",{id:!0,"data-svelte-h":!0}),R(a)!=="svelte-uqik4z"&&(a.textContent=O),l=g(G),u=v(G,"BUTTON",{id:!0,"data-svelte-h":!0}),R(u)!=="svelte-vgx7o6"&&(u.textContent=E),G.forEach(w),k=g(e),m=v(e,"VIDEO",{width:!0,class:!0}),_(m).forEach(w),N=g(e),i=v(e,"DIV",{id:!0}),_(i).forEach(w),M=g(e),b=v(e,"DIV",{id:!0}),_(b).forEach(w),e.forEach(w),this.h()},h(){C(s,"id","my-id"),C(a,"id","join"),C(u,"id","leave"),C(m,"width","400px"),m.playsInline=!0,C(m,"class","svelte-17cowuk"),C(i,"id","remote-media-area"),C(b,"id","button-area")},m(p,e){U(p,t,e),o(t,n),o(n,I),o(n,s),o(s,h),o(t,y),o(t,c),o(c,a),o(c,l),o(c,u),o(t,k),o(t,m),d[6](m),o(t,N),o(t,i),d[7](i),o(t,M),o(t,b),d[8](b),r||(j=[X(a,"click",d[4]),X(u,"click",d[5])],r=!0)},p(p,[e]){e&4&&z(h,p[2])},i:V,o:V,d(p){p&&w(t),d[6](null),d[7](null),d[8](null),r=!1,x(j)}}}function $(d,t,n){let I,s,h="",y,c,a,O,l;B(async()=>{n(3,a=document.getElementById("button-area")),n(1,s=document.getElementById("remote-media-area")),n(2,h=document.getElementById("my-id")),document.getElementById("join"),document.getElementById("leave"),typeof window<"u"&&window.RTCPeerConnection&&(O="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4OGY1OTgwNi1lNWM3LTRmZWYtOGMxMi1jOGQ2ZWRhNTRkYWMiLCJpYXQiOjE3MjY5MTc2MDIsImV4cCI6MTcyNzAwNDAwMiwic2NvcGUiOnsiYXBwIjp7ImlkIjoiZWJlMDBjNjMtMDU1OS00ZjZhLTkyZGEtNWViNGMwNDE1NjVjIiwidHVybiI6dHJ1ZSwiYWN0aW9ucyI6WyJyZWFkIl0sImNoYW5uZWxzIjpbeyJpZCI6IioiLCJuYW1lIjoiKiIsImFjdGlvbnMiOlsid3JpdGUiXSwibWVtYmVycyI6W3siaWQiOiIqIiwibmFtZSI6IioiLCJhY3Rpb25zIjpbIndyaXRlIl0sInB1YmxpY2F0aW9uIjp7ImFjdGlvbnMiOlsid3JpdGUiXX0sInN1YnNjcmlwdGlvbiI6eyJhY3Rpb25zIjpbIndyaXRlIl19fV0sInNmdUJvdHMiOlt7ImFjdGlvbnMiOlsid3JpdGUiXSwiZm9yd2FyZGluZ3MiOlt7ImFjdGlvbnMiOlsid3JpdGUiXX1dfV19XX19fQ.lg0ghxp5uR-WsnIGorzAdZq32IVAV64tQFZZxPKYf50")});async function u(){c=await P.Create(O),y=await q.FindOrCreate(c,{type:"p2p",name:"love_is_war"}),l=await y.join(),n(2,h=l.id);const{audio:i,video:M}=await L.createMicrophoneAudioAndCameraStream();M.attach(I),await I.play(),await l.publish(i),await l.publish(M);const b=r=>{if(r.publisher.id===l.id)return;const j=document.createElement("button");j.id=`subscribe-button-${r.id}`,j.textContent=`${r.publisher.id}: ${r.contentType}`,a.appendChild(j),j.onclick=async()=>{const{stream:p}=await l.subscribe(r.id);let e;switch(p.track.kind){case"video":e=document.createElement("video"),e.playsInline=!0,e.autoplay=!0;break;case"audio":e=document.createElement("audio"),e.controls=!0,e.autoplay=!0;break;default:return}e.id=`media-${r.id}`,p.attach(e),s.appendChild(e)}};y.publications.forEach(b),y.onStreamPublished.add(r=>b(r.publication))}async function E(){l&&(await l.leave(),await y.dispose(),n(2,h=""),a.replaceChildren(),s.replaceChildren())}function k(i){Z[i?"unshift":"push"](()=>{I=i,n(0,I)})}function m(i){Z[i?"unshift":"push"](()=>{s=i,n(1,s)})}function N(i){Z[i?"unshift":"push"](()=>{a=i,n(3,a)})}return[I,s,h,a,u,E,k,m,N]}class ae extends D{constructor(t){super(),F(this,t,$,K,A,{})}}export{ae as component,ne as universal};
