import{r as xe,s as ce,a as Ee,x as L,u as Ne,g as Ce,b as Se,y as Be,z as le,o as lt,A as Xe,e as nt}from"../chunks/scheduler.CjZ6x9ss.js";import{p as X,S as _e,i as pe,z as et,u as Ie,A as tt,a as z,d as p,B as ye,g as re,h as m,q as P,C as st,l as ue,m as fe,o as de,r as he,e as N,s as U,t as Le,D as ot,c as C,f as B,b as qe,k as ke,n as _,E as ee,F as ae,j as it,v as at,w as te,x as rt}from"../chunks/index.DTdbICNU.js";import{a as ct,b as ut,c as ft}from"../chunks/index.CU4dFde9.js";const dt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Me(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ht(n,e){n.d(1),e.delete(n.key)}function mt(n,e,o,t,l,s,i,r,g,f,I,j){let a=n.length,u=s.length,c=a;const F={};for(;c--;)F[n[c].key]=c;const A=[],W=new Map,G=new Map,V=[];for(c=u;c--;){const d=j(l,s,c),Z=o(d);let O=i.get(Z);O?V.push(()=>O.p(d,e)):(O=f(Z,d),O.c()),W.set(Z,A[c]=O),Z in F&&G.set(Z,Math.abs(c-F[Z]))}const q=new Set,Q=new Set;function b(d){X(d,1),d.m(r,I),i.set(d.key,d),I=d.first,u--}for(;a&&u;){const d=A[u-1],Z=n[a-1],O=d.key,T=Z.key;d===Z?(I=d.first,a--,u--):W.has(T)?!i.has(O)||q.has(O)?b(d):Q.has(T)?a--:G.get(O)>G.get(T)?(Q.add(O),b(d)):(q.add(T),a--):(g(Z,i),a--)}for(;a--;){const d=n[a];W.has(d.key)||g(d,i)}for(;u;)b(A[u-1]);return xe(V),A}function be(n,e){const o={},t={},l={$$scope:1};let s=n.length;for(;s--;){const i=n[s],r=e[s];if(r){for(const g in i)g in r||(t[g]=1);for(const g in r)l[g]||(o[g]=r[g],l[g]=1);n[s]=r}else for(const g in i)l[g]=1}for(const i in t)i in o||(o[i]=void 0);return o}function De(n){return typeof n=="object"&&n!==null?n:{}}const gt=!0,_t=!1,Jt=Object.freeze(Object.defineProperty({__proto__:null,prerender:gt,ssr:_t},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-svelte v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};function Qe(n,e,o){const t=n.slice();return t[11]=e[o][0],t[12]=e[o][1],t}function Oe(n){let e,o=[n[12]],t={};for(let l=0;l<o.length;l+=1)t=L(t,o[l]);return{c(){e=et(n[11]),this.h()},l(l){e=tt(l,n[11],{}),z(e).forEach(p),this.h()},h(){ye(e,t)},m(l,s){re(l,e,s)},p(l,s){ye(e,t=be(o,[s&32&&l[12]]))},d(l){l&&p(e)}}}function He(n){let e=n[11],o,t=n[11]&&Oe(n);return{c(){t&&t.c(),o=Ie()},l(l){t&&t.l(l),o=Ie()},m(l,s){t&&t.m(l,s),re(l,o,s)},p(l,s){l[11]?e?ce(e,l[11])?(t.d(1),t=Oe(l),e=l[11],t.c(),t.m(o.parentNode,o)):t.p(l,s):(t=Oe(l),e=l[11],t.c(),t.m(o.parentNode,o)):e&&(t.d(1),t=null,e=l[11])},d(l){l&&p(o),t&&t.d(l)}}}function pt(n){let e,o,t,l,s,i=Me(n[5]),r=[];for(let a=0;a<i.length;a+=1)r[a]=He(Qe(n,i,a));const g=n[10].default,f=Ee(g,n,n[9],null);let I=[Pe,n[7],{width:n[2]},{height:n[2]},{stroke:n[1]},{"stroke-width":t=n[4]?Number(n[3])*24/Number(n[2]):n[3]},{class:l=n[6]("lucide-icon","lucide",n[0]?`lucide-${n[0]}`:"",n[8].class)}],j={};for(let a=0;a<I.length;a+=1)j=L(j,I[a]);return{c(){e=et("svg");for(let a=0;a<r.length;a+=1)r[a].c();o=Ie(),f&&f.c(),this.h()},l(a){e=tt(a,"svg",{width:!0,height:!0,stroke:!0,"stroke-width":!0,class:!0});var u=z(e);for(let c=0;c<r.length;c+=1)r[c].l(u);o=Ie(),f&&f.l(u),u.forEach(p),this.h()},h(){ye(e,j)},m(a,u){re(a,e,u);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);m(e,o),f&&f.m(e,null),s=!0},p(a,[u]){if(u&32){i=Me(a[5]);let c;for(c=0;c<i.length;c+=1){const F=Qe(a,i,c);r[c]?r[c].p(F,u):(r[c]=He(F),r[c].c(),r[c].m(e,o))}for(;c<r.length;c+=1)r[c].d(1);r.length=i.length}f&&f.p&&(!s||u&512)&&Ne(f,g,a,a[9],s?Se(g,a[9],u,null):Ce(a[9]),null),ye(e,j=be(I,[Pe,u&128&&a[7],(!s||u&4)&&{width:a[2]},(!s||u&4)&&{height:a[2]},(!s||u&2)&&{stroke:a[1]},(!s||u&28&&t!==(t=a[4]?Number(a[3])*24/Number(a[2]):a[3]))&&{"stroke-width":t},(!s||u&257&&l!==(l=a[6]("lucide-icon","lucide",a[0]?`lucide-${a[0]}`:"",a[8].class)))&&{class:l}]))},i(a){s||(X(f,a),s=!0)},o(a){P(f,a),s=!1},d(a){a&&p(e),st(r,a),f&&f.d(a)}}}function bt(n,e,o){const t=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"];let l=Be(e,t),{$$slots:s={},$$scope:i}=e,{name:r=void 0}=e,{color:g="currentColor"}=e,{size:f=24}=e,{strokeWidth:I=2}=e,{absoluteStrokeWidth:j=!1}=e,{iconNode:a=[]}=e;const u=(...c)=>c.filter((F,A,W)=>!!F&&W.indexOf(F)===A).join(" ");return n.$$set=c=>{o(8,e=L(L({},e),le(c))),o(7,l=Be(e,t)),"name"in c&&o(0,r=c.name),"color"in c&&o(1,g=c.color),"size"in c&&o(2,f=c.size),"strokeWidth"in c&&o(3,I=c.strokeWidth),"absoluteStrokeWidth"in c&&o(4,j=c.absoluteStrokeWidth),"iconNode"in c&&o(5,a=c.iconNode),"$$scope"in c&&o(9,i=c.$$scope)},e=le(e),[r,g,f,I,j,a,u,l,e,i,s]}class Fe extends _e{constructor(e){super(),pe(this,e,bt,pt,ce,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5})}}function vt(n){let e;const o=n[2].default,t=Ee(o,n,n[3],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,s){t&&t.m(l,s),e=!0},p(l,s){t&&t.p&&(!e||s&8)&&Ne(t,o,l,l[3],e?Se(o,l[3],s,null):Ce(l[3]),null)},i(l){e||(X(t,l),e=!0)},o(l){P(t,l),e=!1},d(l){t&&t.d(l)}}}function wt(n){let e,o;const t=[{name:"mic-off"},n[1],{iconNode:n[0]}];let l={$$slots:{default:[vt]},$$scope:{ctx:n}};for(let s=0;s<t.length;s+=1)l=L(l,t[s]);return e=new Fe({props:l}),{c(){ue(e.$$.fragment)},l(s){fe(e.$$.fragment,s)},m(s,i){de(e,s,i),o=!0},p(s,[i]){const r=i&3?be(t,[t[0],i&2&&De(s[1]),i&1&&{iconNode:s[0]}]):{};i&8&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(X(e.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),o=!1},d(s){he(e,s)}}}function kt(n,e,o){let{$$slots:t={},$$scope:l}=e;const s=[["line",{x1:"2",x2:"22",y1:"2",y2:"22"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}]];return n.$$set=i=>{o(1,e=L(L({},e),le(i))),"$$scope"in i&&o(3,l=i.$$scope)},e=le(e),[s,e,t,l]}class It extends _e{constructor(e){super(),pe(this,e,kt,wt,ce,{})}}function yt(n){let e;const o=n[2].default,t=Ee(o,n,n[3],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,s){t&&t.m(l,s),e=!0},p(l,s){t&&t.p&&(!e||s&8)&&Ne(t,o,l,l[3],e?Se(o,l[3],s,null):Ce(l[3]),null)},i(l){e||(X(t,l),e=!0)},o(l){P(t,l),e=!1},d(l){t&&t.d(l)}}}function Mt(n){let e,o;const t=[{name:"mic"},n[1],{iconNode:n[0]}];let l={$$slots:{default:[yt]},$$scope:{ctx:n}};for(let s=0;s<t.length;s+=1)l=L(l,t[s]);return e=new Fe({props:l}),{c(){ue(e.$$.fragment)},l(s){fe(e.$$.fragment,s)},m(s,i){de(e,s,i),o=!0},p(s,[i]){const r=i&3?be(t,[t[0],i&2&&De(s[1]),i&1&&{iconNode:s[0]}]):{};i&8&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(X(e.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),o=!1},d(s){he(e,s)}}}function Et(n,e,o){let{$$slots:t={},$$scope:l}=e;const s=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}]];return n.$$set=i=>{o(1,e=L(L({},e),le(i))),"$$scope"in i&&o(3,l=i.$$scope)},e=le(e),[s,e,t,l]}class Nt extends _e{constructor(e){super(),pe(this,e,Et,Mt,ce,{})}}function Ct(n){let e;const o=n[2].default,t=Ee(o,n,n[3],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,s){t&&t.m(l,s),e=!0},p(l,s){t&&t.p&&(!e||s&8)&&Ne(t,o,l,l[3],e?Se(o,l[3],s,null):Ce(l[3]),null)},i(l){e||(X(t,l),e=!0)},o(l){P(t,l),e=!1},d(l){t&&t.d(l)}}}function St(n){let e,o;const t=[{name:"phone"},n[1],{iconNode:n[0]}];let l={$$slots:{default:[Ct]},$$scope:{ctx:n}};for(let s=0;s<t.length;s+=1)l=L(l,t[s]);return e=new Fe({props:l}),{c(){ue(e.$$.fragment)},l(s){fe(e.$$.fragment,s)},m(s,i){de(e,s,i),o=!0},p(s,[i]){const r=i&3?be(t,[t[0],i&2&&De(s[1]),i&1&&{iconNode:s[0]}]):{};i&8&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(X(e.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),o=!1},d(s){he(e,s)}}}function jt(n,e,o){let{$$slots:t={},$$scope:l}=e;const s=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"}]];return n.$$set=i=>{o(1,e=L(L({},e),le(i))),"$$scope"in i&&o(3,l=i.$$scope)},e=le(e),[s,e,t,l]}class At extends _e{constructor(e){super(),pe(this,e,jt,St,ce,{})}}const{document:Te}=dt;function Ke(n,e,o){const t=n.slice();return t[29]=e[o],t}function $e(n,e){let o,t,l,s;return{key:n,first:null,c(){o=N("div"),t=N("img"),s=U(),this.h()},l(i){o=C(i,"DIV",{class:!0,style:!0});var r=z(o);t=C(r,"IMG",{src:!0,alt:!0,class:!0}),s=B(r),r.forEach(p),this.h()},h(){Xe(t.src,l="src/lib/images/"+e[29].image)||_(t,"src",l),_(t,"alt","Emotion Image"),_(t,"class","fade svelte-1w98clh"),_(o,"class","fukidasi absolute svelte-1w98clh"),te(o,"top",e[29].position.top),te(o,"left",e[29].position.left),te(o,"right",e[29].position.right),te(o,"bottom",e[29].position.bottom),this.first=o},m(i,r){re(i,o,r),m(o,t),m(o,s)},p(i,r){e=i,r[0]&4&&!Xe(t.src,l="src/lib/images/"+e[29].image)&&_(t,"src",l),r[0]&4&&te(o,"top",e[29].position.top),r[0]&4&&te(o,"left",e[29].position.left),r[0]&4&&te(o,"right",e[29].position.right),r[0]&4&&te(o,"bottom",e[29].position.bottom)},d(i){i&&p(o)}}}function Wt(n){let e,o;return e=new It({props:{class:"w-8 h-8"}}),{c(){ue(e.$$.fragment)},l(t){fe(e.$$.fragment,t)},m(t,l){de(e,t,l),o=!0},i(t){o||(X(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){he(e,t)}}}function Ot(n){let e,o;return e=new Nt({props:{class:"w-8 h-8"}}),{c(){ue(e.$$.fragment)},l(t){fe(e.$$.fragment,t)},m(t,l){de(e,t,l),o=!0},i(t){o||(X(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){he(e,t)}}}function Tt(n){let e,o,t,l,s,i,r,g,f,I,j="喜",a,u,c="怒",F,A,W="哀",G,V,q="楽",Q,b,d=[],Z=new Map,O,T,H,me,ne,ge,se,D,M,R,v,J,w,S,k,Y,oe,$,je,Ve,ve=Me(n[2]);const ze=h=>h[29].id;for(let h=0;h<ve.length;h+=1){let y=Ke(n,ve,h),E=ze(y);Z.set(E,d[h]=$e(E,y))}const Ge=[Ot,Wt],ie=[];function Ze(h,y){return h[1]?0:1}return w=Ze(n),S=ie[w]=Ge[w](n),oe=new At({props:{class:"w-8 h-8"}}),{c(){e=N("meta"),o=U(),t=N("section"),l=N("p"),s=Le("ID: "),i=N("span"),r=Le(n[4]),g=U(),f=N("div"),I=N("button"),I.textContent=j,a=U(),u=N("button"),u.textContent=c,F=U(),A=N("button"),A.textContent=W,G=U(),V=N("button"),V.textContent=q,Q=U(),b=N("article");for(let h=0;h<d.length;h+=1)d[h].c();O=U(),T=N("div"),H=N("video"),me=U(),ne=N("div"),ge=U(),se=N("div"),D=U(),M=N("div"),R=U(),v=N("div"),J=N("button"),S.c(),k=U(),Y=N("button"),ue(oe.$$.fragment),this.h()},l(h){const y=ot("svelte-xgg23l",Te.head);e=C(y,"META",{name:!0,content:!0,class:!0}),y.forEach(p),o=B(h),t=C(h,"SECTION",{class:!0});var E=z(t);l=C(E,"P",{class:!0});var Ae=z(l);s=qe(Ae,"ID: "),i=C(Ae,"SPAN",{id:!0,class:!0});var Je=z(i);r=qe(Je,n[4]),Je.forEach(p),Ae.forEach(p),g=B(E),f=C(E,"DIV",{class:!0});var x=z(f);I=C(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ke(I)!=="svelte-1o2mll0"&&(I.textContent=j),a=B(x),u=C(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ke(u)!=="svelte-8hmwgh"&&(u.textContent=c),F=B(x),A=C(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ke(A)!=="svelte-1dqnekx"&&(A.textContent=W),G=B(x),V=C(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ke(V)!=="svelte-v34who"&&(V.textContent=q),x.forEach(p),Q=B(E),b=C(E,"ARTICLE",{class:!0});var K=z(b);for(let We=0;We<d.length;We+=1)d[We].l(K);O=B(K),T=C(K,"DIV",{class:!0});var Re=z(T);H=C(Re,"VIDEO",{class:!0}),z(H).forEach(p),Re.forEach(p),me=B(K),ne=C(K,"DIV",{class:!0}),z(ne).forEach(p),ge=B(K),se=C(K,"DIV",{class:!0}),z(se).forEach(p),D=B(K),M=C(K,"DIV",{class:!0}),z(M).forEach(p),K.forEach(p),R=B(E),v=C(E,"DIV",{class:!0});var we=z(v);J=C(we,"BUTTON",{class:!0});var Ye=z(J);S.l(Ye),Ye.forEach(p),k=B(we),Y=C(we,"BUTTON",{class:!0});var Ue=z(Y);fe(oe.$$.fragment,Ue),Ue.forEach(p),we.forEach(p),E.forEach(p),this.h()},h(){Te.title="天才たちの恋愛頭脳戦通話アプリ",_(e,"name","description"),_(e,"content","SvelteKit video call application"),_(e,"class","svelte-1w98clh"),_(i,"id","my-id"),_(i,"class","svelte-1w98clh"),_(l,"class","text-center svelte-1w98clh"),_(I,"class","px-4 py-2 bg-yellow-400 text-black rounded-full svelte-1w98clh"),_(u,"class","px-4 py-2 bg-red-500 text-white rounded-full svelte-1w98clh"),_(A,"class","px-4 py-2 bg-blue-500 text-white rounded-full svelte-1w98clh"),_(V,"class","px-4 py-2 bg-green-500 text-white rounded-full svelte-1w98clh"),_(f,"class","flex space-x-4 justify-center svelte-1w98clh"),_(H,"class","w-full h-full object-cover svelte-1w98clh"),H.muted=!0,H.playsInline=!0,_(T,"class","panel flex-grow basis-[400px] relative border-8 svelte-1w98clh"),ee(T,"border-red-500",n[5]),ee(T,"border-black",!n[5]),_(ne,"class","panel flex-grow basis-[500px] cartoon-frame svelte-1w98clh"),_(se,"class","panel flex-grow basis-[500px] cartoon-frame svelte-1w98clh"),_(M,"class","panel flex-grow basis-[400px] cartoon-frame svelte-1w98clh"),_(b,"class","flex flex-wrap font-comic-sans p-[5vmin] mx-64 relative svelte-1w98clh"),_(J,"class","w-16 h-16 rounded-full border-2 border-black flex items-center justify-center bg-gray-200 svelte-1w98clh"),_(Y,"class","w-16 h-16 rounded-full border-2 border-black flex items-center justify-center transition-colors duration-300 svelte-1w98clh"),ee(Y,"bg-[#57EEF8]",n[0]),ee(Y,"bg-[#EE1971]",!n[0]),_(v,"class","flex space-x-4 justify-center svelte-1w98clh"),_(t,"class","min-h-screen bg-gray-100 svelte-1w98clh")},m(h,y){m(Te.head,e),re(h,o,y),re(h,t,y),m(t,l),m(l,s),m(l,i),m(i,r),m(t,g),m(t,f),m(f,I),m(f,a),m(f,u),m(f,F),m(f,A),m(f,G),m(f,V),m(t,Q),m(t,b);for(let E=0;E<d.length;E+=1)d[E]&&d[E].m(b,null);m(b,O),m(b,T),m(T,H),n[13](H),m(b,me),m(b,ne),m(b,ge),m(b,se),m(b,D),m(b,M),m(t,R),m(t,v),m(v,J),ie[w].m(J,null),m(v,k),m(v,Y),de(oe,Y,null),$=!0,je||(Ve=[ae(I,"click",n[9]),ae(u,"click",n[10]),ae(A,"click",n[11]),ae(V,"click",n[12]),ae(J,"click",n[8]),ae(Y,"click",n[7])],je=!0)},p(h,y){(!$||y[0]&16)&&it(r,h[4]),y[0]&4&&(ve=Me(h[2]),d=mt(d,y,ze,1,h,ve,Z,b,ht,$e,O,Ke)),(!$||y[0]&32)&&ee(T,"border-red-500",h[5]),(!$||y[0]&32)&&ee(T,"border-black",!h[5]);let E=w;w=Ze(h),w!==E&&(rt(),P(ie[E],1,1,()=>{ie[E]=null}),at(),S=ie[w],S||(S=ie[w]=Ge[w](h),S.c()),X(S,1),S.m(J,null)),(!$||y[0]&1)&&ee(Y,"bg-[#57EEF8]",h[0]),(!$||y[0]&1)&&ee(Y,"bg-[#EE1971]",!h[0])},i(h){$||(X(S),X(oe.$$.fragment,h),$=!0)},o(h){P(S),P(oe.$$.fragment,h),$=!1},d(h){h&&(p(o),p(t)),p(e);for(let y=0;y<d.length;y+=1)d[y].d();n[13](null),ie[w].d(),he(oe),je=!1,xe(Ve)}}}let Dt=.02;function Ft(n,e){n.audioContext=new AudioContext;const o=n.audioContext.createMediaStreamSource(new MediaStream([e.track])),t=n.audioContext.createAnalyser();t.fftSize=256,o.connect(t);const l=new Float32Array(t.fftSize);function s(){t.getFloatTimeDomainData(l);let i=0;for(let f=0;f<l.length;f++)i+=l[f]*l[f];let r=Math.sqrt(i/l.length);const g=.02;n.isSpeaking=r>g,n.panel&&(n.isSpeaking?(n.panel.classList.add("border-red-500"),n.panel.classList.remove("border-black")):(n.panel.classList.add("border-black"),n.panel.classList.remove("border-red-500"))),n.animationId=requestAnimationFrame(s)}s()}function Vt(n,e,o){let t=!0,l=!0,s=[];const i={happy:"Nomal1.png",angry:"DO.png",sad:"think.png",surprised:"Do2.png"},r=[{top:"0",left:"0"},{top:"0",right:"0"},{bottom:"0",left:"0"},{bottom:"0",right:"0"}];function g(D){const M=r[Math.floor(Math.random()*r.length)],R={image:i[D],position:M,id:Date.now()};o(2,s=[...s,R]),setTimeout(()=>{o(2,s=s.filter(v=>v.id!==R.id))},5e3)}function f(){o(0,t=!t),t?O():Z()}function I(){o(1,l=!l),G&&(G.track.enabled=l)}let j,a=[],u="",c,F,A,W,G,V,q,Q,b=!1,d={};lt(async()=>{a=Array.from(document.getElementsByClassName("cartoon-frame")),typeof window<"u"&&window.RTCPeerConnection&&(A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4OGY1OTgwNi1lNWM3LTRmZWYtOGMxMi1jOGQ2ZWRhNTRkYWMiLCJpYXQiOjE3MjY5MTc2MDIsImV4cCI6MTcyNzAwNDAwMiwic2NvcGUiOnsiYXBwIjp7ImlkIjoiZWJlMDBjNjMtMDU1OS00ZjZhLTkyZGEtNWViNGMwNDE1NjVjIiwidHVybiI6dHJ1ZSwiYWN0aW9ucyI6WyJyZWFkIl0sImNoYW5uZWxzIjpbeyJpZCI6IioiLCJuYW1lIjoiKiIsImFjdGlvbnMiOlsid3JpdGUiXSwibWVtYmVycyI6W3siaWQiOiIqIiwibmFtZSI6IioiLCJhY3Rpb25zIjpbIndyaXRlIl0sInB1YmxpY2F0aW9uIjp7ImFjdGlvbnMiOlsid3JpdGUiXX0sInN1YnNjcmlwdGlvbiI6eyJhY3Rpb25zIjpbIndyaXRlIl19fV0sInNmdUJvdHMiOlt7ImFjdGlvbnMiOlsid3JpdGUiXSwiZm9yd2FyZGluZ3MiOlt7ImFjdGlvbnMiOlsid3JpdGUiXX1dfV19XX19fQ.lg0ghxp5uR-WsnIGorzAdZq32IVAV64tQFZZxPKYf50")});async function Z(){F=await ct.Create(A),c=await ut.FindOrCreate(F,{type:"p2p",name:"love_is_war"}),W=await c.join(),o(4,u=W.id);const{audio:D,video:M}=await ft.createMicrophoneAudioAndCameraStream();G=D,V=M,M.attach(j),await j.play(),await W.publish(D),await W.publish(M),T();const R=async v=>{if(v.publisher.id===W.id)return;const J=v.publisher.id;d[J]||(d[J]={panel:null,videoElement:null,audioElement:null,isSpeaking:!1,audioContext:null,animationId:null});const w=d[J],{stream:S}=await W.subscribe(v.id);if(!w.panel){const k=a.find(Y=>Y.childElementCount===0);if(!k)return;w.panel=k,w.panel.classList.add("border-8","border-black","relative")}if(S.track.kind==="video"){const k=document.createElement("video");k.playsInline=!0,k.autoplay=!0,k.className="w-full h-full object-cover",S.attach(k),w.panel.appendChild(k),w.videoElement=k}else if(S.track.kind==="audio"){const k=document.createElement("audio");k.autoplay=!0,S.attach(k),w.audioElement=k,Ft(w,S)}};c.publications.forEach(R),c.onStreamPublished.add(v=>R(v.publication))}async function O(){if(W){await W.leave(),await c.dispose(),o(4,u=""),a.forEach(D=>D.replaceChildren()),G&&(G.track.stop(),G=null),V&&(V.track.stop(),V=null),q&&(q.close(),q=null),Q&&(cancelAnimationFrame(Q),Q=null);for(let D in d){const M=d[D];M.audioContext&&(M.audioContext.close(),M.audioContext=null),M.animationId&&(cancelAnimationFrame(M.animationId),M.animationId=null)}d={}}}function T(){q=new AudioContext;const D=new MediaStream([G.track]),M=q.createMediaStreamSource(D),R=q.createAnalyser();R.fftSize=256,M.connect(R);const v=new Float32Array(R.fftSize);function J(){R.getFloatTimeDomainData(v);let w=0;for(let k=0;k<v.length;k++)w+=v[k]*v[k];let S=Math.sqrt(w/v.length);o(5,b=S>Dt),Q=requestAnimationFrame(J)}J()}const H=()=>g("happy"),me=()=>g("angry"),ne=()=>g("sad"),ge=()=>g("surprised");function se(D){nt[D?"unshift":"push"](()=>{j=D,o(3,j)})}return[t,l,s,j,u,b,g,f,I,H,me,ne,ge,se]}class Rt extends _e{constructor(e){super(),pe(this,e,Vt,Tt,ce,{},null,[-1,-1])}}export{Rt as component,Jt as universal};
