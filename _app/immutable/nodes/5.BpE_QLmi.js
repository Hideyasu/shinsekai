import{s as A,n as V,r as x,o as D,d as Z}from"../chunks/scheduler.BsRx5FeT.js";import{S as F,i as B,e as b,t as Y,s as g,c as v,a as j,b as R,d as w,f as k,k as T,n as _,g as U,h as n,u as X,j as z}from"../chunks/index.BE96ZQnQ.js";import{a as P,b as q,c as L}from"../chunks/index.CU4dFde9.js";const Q=!1,H=!0,ae=Object.freeze(Object.defineProperty({__proto__:null,prerender:H,ssr:Q},Symbol.toStringTag,{value:"Module"}));function K(l){let t,a,p,d,I,h,c,o,O="join",r,u,E="leave",N,m,W,i,M,y,f,C;return{c(){t=b("main"),a=b("p"),p=Y("ID: "),d=b("span"),I=Y(l[2]),h=g(),c=b("div"),o=b("button"),o.textContent=O,r=g(),u=b("button"),u.textContent=E,N=g(),m=b("video"),W=g(),i=b("div"),M=g(),y=b("div"),this.h()},l(e){t=v(e,"MAIN",{});var s=j(t);a=v(s,"P",{});var J=j(a);p=R(J,"ID: "),d=v(J,"SPAN",{id:!0});var S=j(d);I=R(S,l[2]),S.forEach(w),J.forEach(w),h=k(s),c=v(s,"DIV",{});var G=j(c);o=v(G,"BUTTON",{id:!0,"data-svelte-h":!0}),T(o)!=="svelte-uqik4z"&&(o.textContent=O),r=k(G),u=v(G,"BUTTON",{id:!0,"data-svelte-h":!0}),T(u)!=="svelte-vgx7o6"&&(u.textContent=E),G.forEach(w),N=k(s),m=v(s,"VIDEO",{width:!0,class:!0}),j(m).forEach(w),W=k(s),i=v(s,"DIV",{id:!0}),j(i).forEach(w),M=k(s),y=v(s,"DIV",{id:!0}),j(y).forEach(w),s.forEach(w),this.h()},h(){_(d,"id","my-id"),_(o,"id","join"),_(u,"id","leave"),_(m,"width","400px"),m.playsInline=!0,_(m,"class","svelte-18x6m0o"),_(i,"id","remote-media-area"),_(y,"id","button-area")},m(e,s){U(e,t,s),n(t,a),n(a,p),n(a,d),n(d,I),n(t,h),n(t,c),n(c,o),n(c,r),n(c,u),n(t,N),n(t,m),l[6](m),n(t,W),n(t,i),l[7](i),n(t,M),n(t,y),l[8](y),f||(C=[X(o,"click",l[4]),X(u,"click",l[5])],f=!0)},p(e,[s]){s&4&&z(I,e[2])},i:V,o:V,d(e){e&&w(t),l[6](null),l[7](null),l[8](null),f=!1,x(C)}}}function $(l,t,a){let p,d,I="",h,c,o,O,r;D(async()=>{a(3,o=document.getElementById("button-area")),a(1,d=document.getElementById("remote-media-area")),a(2,I=document.getElementById("my-id")),document.getElementById("join"),document.getElementById("leave"),typeof window<"u"&&window.RTCPeerConnection&&(O="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4OGY1OTgwNi1lNWM3LTRmZWYtOGMxMi1jOGQ2ZWRhNTRkYWMiLCJpYXQiOjE3MjY5MTc2MDIsImV4cCI6MTcyNzAwNDAwMiwic2NvcGUiOnsiYXBwIjp7ImlkIjoiZWJlMDBjNjMtMDU1OS00ZjZhLTkyZGEtNWViNGMwNDE1NjVjIiwidHVybiI6dHJ1ZSwiYWN0aW9ucyI6WyJyZWFkIl0sImNoYW5uZWxzIjpbeyJpZCI6IioiLCJuYW1lIjoiKiIsImFjdGlvbnMiOlsid3JpdGUiXSwibWVtYmVycyI6W3siaWQiOiIqIiwibmFtZSI6IioiLCJhY3Rpb25zIjpbIndyaXRlIl0sInB1YmxpY2F0aW9uIjp7ImFjdGlvbnMiOlsid3JpdGUiXX0sInN1YnNjcmlwdGlvbiI6eyJhY3Rpb25zIjpbIndyaXRlIl19fV0sInNmdUJvdHMiOlt7ImFjdGlvbnMiOlsid3JpdGUiXSwiZm9yd2FyZGluZ3MiOlt7ImFjdGlvbnMiOlsid3JpdGUiXX1dfV19XX19fQ.lg0ghxp5uR-WsnIGorzAdZq32IVAV64tQFZZxPKYf50")});async function u(){c=await P.Create(O),h=await q.FindOrCreate(c,{type:"p2p",name:"love_is_war"}),r=await h.join(),a(2,I=r.id);const{audio:i,video:M}=await L.createMicrophoneAudioAndCameraStream();M.attach(p),await p.play(),await r.publish(i),await r.publish(M);const y=async f=>{if(f.publisher.id===r.id)return;const{stream:C}=await r.subscribe(f.id);let e;switch(C.track.kind){case"video":e=document.createElement("video"),e.playsInline=!0,e.autoplay=!0,C.attach(e);break;case"audio":e=document.createElement("audio"),e.controls=!0,e.autoplay=!0,C.attach(e);break;default:return}e.id=`media-${f.id}`,d.appendChild(e)};h.publications.forEach(y),h.onStreamPublished.add(f=>y(f.publication))}async function E(){r&&(await r.leave(),await h.dispose(),a(2,I=""),o.replaceChildren(),d.replaceChildren())}function N(i){Z[i?"unshift":"push"](()=>{p=i,a(0,p)})}function m(i){Z[i?"unshift":"push"](()=>{d=i,a(1,d)})}function W(i){Z[i?"unshift":"push"](()=>{o=i,a(3,o)})}return[p,d,I,o,u,E,N,m,W]}class ne extends F{constructor(t){super(),B(this,t,$,K,A,{})}}export{ne as component,ae as universal};
